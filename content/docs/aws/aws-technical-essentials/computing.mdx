---
title: "AWS 컴퓨팅"
description: "AWS Technical Essentials 트랙의 두 번째 단원 학습 정리 내용"
---

## 서비스형 컴퓨팅

<Callout>
  기본적인 수준에서 **가상 머신(VM), 컨테이너 서비스, 서버리스**라는 3가지
  유형의 컴퓨팅 옵션을 사용할 수 있습니다.
</Callout>

### 서버

- 대개 HTTP 요청을 처리하면 클라이언트-서버 모델을 따라 응답을 클라이언트에게 보낸다.
  - API 기반 통신도 해당 모델에 속함
- 사용자 요청 처리 및 응답을 위해 CPU, 메모리, 네트워킹 기능을 제공하여 애플리케이션을 구동한다.
- HTTP 서버 예시) IIS와 같은 Windows 옵션, Apache HTTP Server, Nginx, Tomcat과 같은 Linux 옵션

### 적합한 컴퓨팅 옵션 선택

- 기본적인 수준에서 가상 머신(인스턴스), 컨테이너, 서버리스 중 선택할 수 있다.
- 인프라에 관한 지식이 있다면 **가상 머신(VM)**
  - 호스트 머신에 하이퍼바이저[^hypervisor]를 설치하고 가상 머신을 실행
- AWS에서는 EC2라는 서비스를 제공하고 있다.

---

## Amazon EC2 시작하기

<Callout>
  어떤 애플리케이션이든 가용성이 높게 아키텍팅할 때는 2개의 각기 다른 가용
  영역에 최소한 2개의 EC2 인스턴스를 사용하는 것을 고려하십시오.
</Callout>

### Amazon EC2

- 클라우드에서 안전하고 크기 조정이 가능한 컴퓨팅 용량을 제공하는 웹 서비스
- EC2 인스턴스 생성을 위한 구성 요소
  - 하드웨어 사양: CPU, 메모리, 네트워크, 스토리지
  - 논리적 구성: 네트워킹 위치, 방화벽 규칙, 인증, 원하는 운영 체제

### Amazon Machine Image

- EC2 인스턴스를 시작할 때 첫 번째로 설정하는 것이다.
- 원하는 운영 체제 구성, 스토리지 매핑, 아키텍처 유형, 시작 권한, 그리고 사전 설치된 추가 소프트웨어 애플리케이션이 포함된다.
- AMI는 재사용이 가능하고 새로운 EC2 인스턴스를 구성할 때 활용할 수 있다.

#### AMI와 EC2 인스턴스 간 관계

- EC2 인스턴스는 AMI에 정의된 내용이 실제로 인스턴스화된 것이다.
  - 케이크로 비유하자면 케이크는 케이크 레시피가 실제로 인스턴스화된 것이다.

#### AMI 찾기

- Quick Start AMI, AWS Marketplace AMI, 내 AMI, 커뮤니티 AMI, 사용자 지정 이미지 등
- AWS Management Console의 각 AMI에는 AMI ID가 있고, 접두사 `ami-` 를 갖는다.

### EC2 구성

- EC2 인스턴스 생성을 위해 **인스턴스 유형, 네트워크, 스토리지 등**의 구성을 설정해야 한다.
- 온프레미스의 경우 서버 용량 결정을 위한 초기 자본이 들어가겠지만 클라우드 기반 서비스는 간단한 API 호출로 변경 가능하다.

### Amazon EC2 인스턴스 유형

- EC2 인스턴스는 가상 프로세서(vCPU), 메모리, 네트워크, 그리고 경우에 따라 인스턴스 스토리지 및 그래픽 처리 장치(GPU)의 조합이다.
- 인스턴스 유형의 이름은 다음과 같이 분석할 수 있다.
  - 첫 번째 자리: 인스턴스 패밀리
  - 두 번째 자리: 인스턴스의 세대
  - 마침표 앞에 있는 나머지 문자: 스토리지 같은 추가 속성
  - 마침표 다음: 인스턴스의 크기

### 인스턴스 패밀리

- 각 인스턴스 패밀리는 각각의 사용 사례에 맞게 최적화되어 있다.
- 자세한 내용은 [해당 링크](http://docs.aws.amazon.com/ko_kr/AWSEC2/latest/UserGuide/instance-types.html)에서

### EC2 인스턴스 위치

- 달리 지정하지 않는 한 EC2 인스턴스를 시작하면 인스턴스가 기본 VPC(Virtual Private Cloud)[^vpc]에 배치된다.
- 기본 VPC에 넣은 모든 리소스는 퍼블릭으로 설정되고 인터넷에서 엑세스할 수 있기 때문에 고객 데이터 또는 개인 정보를 이러한 VPC에 배치하면 안된다.

### 고가용성을 위한 아키텍팅

- 네트워크에서 인스턴스는 선택한 가용 영역에 상주한다.
- EC2 인스턴스는 큰 인스턴스 몇 개 보다 작은 인스턴스를 많이 사용하는 것이 아키텍쳐 설계에 유리하다.
- 인스턴스를 분리하여 설계할 경우 하나가 다운되도 가용성에 영향을 덜 받는다.

---

## Amazon EC2 인스턴스 수명 주기

<Callout>
  EC2 인스턴스는 인스턴스를 생성하는 순간부터 종료될 때까지 여러 상태를
  거칩니다.
</Callout>

### EC2 인스턴스 수명 주기

<Mermaid
  chart="stateDiagram-v2
    direction LR
    [*] --> 보류중 : ①
    보류중 --> 실행중 : ②
    실행중 --> 재부팅중 : ③
    재부팅중 --> 실행중
    실행중 --> 종료중 : 종료
    종료중 --> 종료됨
    실행중 --> 중지중 : ④ 절전 모드 중지
    중지중 --> 중지됨
    중지됨 --> 보류중
    종료됨 --> [*] : ⑤ 종료"
/>

1. 인스턴스를 시작하면 Pending 상태로 진입한다. 대기 중인 경우 요금이 부과되지 않으며 실행 중 상태로 들어갈 준비를 한다.
2. 인스턴스가 Running 상태면 사용할 준비가 된 것이고, 요금 부과가 시작되는 단계다.
3. 인스턴스를 재부팅하면 중지 작업 다음 시작을 수행하는 것과는 다르다. 운영 체제를 재부팅하는 것과 동일하며 퍼블릭 DNS 이름, 프라이빗 및 퍼블릭 IPv4 주소를 유지한다.
4. 인스턴스를 중지하면 Stopping 상태로 전환된 다음, Stopped 상태로 들어간다. 랩톱 종료와 동일하며 중지 후 시작을 하면 새로운 기본 물리적 서버에 배치될 수 있다.
5. 인스턴스를 종료하면 인스턴스 스토어가 삭제되고 퍼블릭 IP 주소와 프라이빗 IP 주소가 모두 손실된다.

#### 중지 및 중지-최대 절전 모드의 차이점

- 인스턴스 중지는 중지 중에서 중지됨 상태로 전환되는 것을 의미한다.
  - 중지 후에는 사용량/데이터 전송 요금이 없지만, Amazon EBS 볼륨 요금은 계속 발생한다.
- 최대 절전 모드 중지는 EC2가 OS에 절전 모드 진입 신호를 전송하고 RAM 내용이 EBS 볼륨 루트에 저장된다.
  - 최대 절전 모드 설정이 활성화되어 있고, 사전 조건을 충족해야 사용 가능하다.

### 요금

- 애플리케이션 실행 방식에 적합한 요금 옵션을 설정하면 비용을 절감할 수 있다.
- 온디맨드: 사용한 만큼만 시간/초 단위로 지불
- 스팟 인스턴스: 온디맨드 대비 최대 90% 저렴, 남는 요금을 경매식으로 사용
- 절감형 플랜: 1~3년 약정, 최대 72% 절감
- 예약 인스턴스: 최대 72% 할인 (1년/3년 약정)
- 전용 호스트: 온디맨드 또는 예약 구매 가능 (최대 70% 할인), 물리 서버 단위 제공 및 라이센스 BYOL 가능

---

## 컨테이너 서비스

<Callout>
  모든 목적에 부합하는 컴퓨팅 서비스란 존재하지 않습니다. 요구 사항에 맞춰
  선택해야 합니다. 핵심은 각 옵션이 무엇을 제공하는지 이해하는 것입니다.
</Callout>

- 컨테이너와 컨테이너를 실행하는 방법을 알아본다.
- 컨테이너는 웹 애플리케이션, 리프트 앤 시프트 마이그레이션, 분산 마이그레이션, 개발, 테스트 및 프로덕션 환경의 간소화 등 다양한 워크로드를 호스팅할 수 있다.

### 컨테이너

- 코드와 종속성을 함께 패키징한 표준화된 실행 단위
- 환경 간 이식성 보장과 독립된 실행 환경을 제공한다는 특징을 갖는다.
- 대표적인 컨테이너 플랫폼으로 Docker가 있으며 컨테이너의 생성, 패키징, 배포, 실행을 지원한다.

### VM과 컨테이너의 차이점

<Mermaid
    chart="flowchart TB

    subgraph VM1[가상 머신 1]
        App1[애플리케이션 1]
        GuestOS1[게스트 OS1]
    end

    subgraph VM2[가상 머신 2]
        App2[애플리케이션 2]
        GuestOS2[게스트 OS2]
    end

    subgraph VM3[가상 머신 3]
        App3[애플리케이션 3]
        GuestOS3[게스트 OS3]
    end

    VM1 --> hypervisor
    VM2 --> hypervisor
    VM3 --> hypervisor

    hypervisor[가상화 플랫폼] --> HostOSVM[호스트 운영 체제] --> 서버

"
/>

<Mermaid
    chart="flowchart TB
    ContainerPlatform[컨테이너화 플랫폼] --> HostOSC[운영 체제] --> 서버

    subgraph C1[컨테이너 1]
        AppC1[애플리케이션 1]
    end

    subgraph C2[컨테이너 2]
        AppC2[애플리케이션 2]
    end

    subgraph C3[컨테이너 3]
        AppC3[애플리케이션 3]
    end

    C1 --> ContainerPlatform
    C2 --> ContainerPlatform
    C3 --> ContainerPlatform"

/>

[^hypervisor]: 단일 물리적 컴퓨터에서 여러 개의 가상 머신을 실행할 수 있도록 하는 소프트웨어
[^vpc]: 자체 데이터 센터에서 운영하는 기존 네트워크와 아주 유사한 가상 네트워크. VPC를 추가하고 서브넷을 추가할 수 있다.
